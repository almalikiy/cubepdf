CubePDF ユーザーマニュアル
====

Copyright © 2010 CubeSoft, Inc.  
GNU Affero General Public License version 3 (AGPLv3)  
support@cube-soft.jp  
https://www.cube-soft.jp/cubepdf/

## CubePDF による変換手順

![PDF への変換手順](https://raw.githubusercontent.com/cube-soft/cube.assets/master/cubepdf/doc/v4/ja/overview.png)

CubePDF は **仮想プリンター** としてインストールされます。そのため、Microsoft Edge や Google Chrome やなどの Web ブラウザ、Microsoft Word, Excel, PowerPoint など **印刷** ボタンのあるアプリケーションであれば何でも、次の 3 ステップで PDF へ変換する事ができます。

1. PDF 化したいものを適当なアプリケーションで表示し **印刷** を選択します。
2. 利用できるプリンターの一覧から **CubePDF** を選択し **印刷** ボタンをクリックします。
3. CubePDF のメイン画面で **出力ファイル** 等の設定内容を確認し **変換** ボタンをクリックします。

指定した名前の PDF ファイルが既に存在する場合、既存の PDF ファイルに結合する事もできます。既存の PDF ファイルに対する指定方法は次の 4 通りです。

* **上書き**  
  既存の PDF ファイルを新しい PDF ファイルで上書きします。
* **先頭に結合**  
  既存の PDF ファイルの先頭に、変換内容を結合します。
* **末尾に結合**  
  既存の PDF ファイルの末尾に、変換内容を結合します。
* **リネーム**   
  sample (2).pdf のように、自動的に別のファイル名で保存します。

ただし、結合先の PDF ファイルがパスワードによって保護されている時は、セキュリティ機能で同じ管理用パスワードを設定した場合のみ結合する事ができます。

### 注意

CubePDF は **仮想プリンター** と呼ばれるソフトウェアで、他のアプリケーションの **印刷** を介して実行されます。そのため、通常のアプリケーションのようにデスクトップやスタートメニュー等から直接 CubePDF を 実行したり、PDF ファイル等に関連付けたりして利用する事はできません。

また、CubePDF は変換機能のみを提供し、変換後のファイルを閲覧するには別途アプリケーションが必要です。例えば、PDF ファイルを閲覧するアプリケーションとしては [Adobe Acrobat Reader DC](https://get.adobe.com/reader/) 等が挙げられます。

## 変換操作および設定内容の一覧

### 一般

CubePDF は PDF 以外のファイル形式にも変換する事ができます。PDF 以外のファイル形式に変換したい場合、**ファイルタイプ** の選択項目の中から変換したいものを選択して下さい。

尚、PNG のように複数のページを保持できないファイル形式の場合、変換するページ数だけファイルが作成されます。例えば、出力ファイル名が Sample.png の場合、実際には Sample-01.png, Sample-02.png, ... と言った名前のファイルが作成されます。

![CubePDF の設定内容一覧](https://raw.githubusercontent.com/cube-soft/cube.assets/master/cubepdf/doc/v4/ja/main/format.png)

ファイルタイプが PDF の場合、PDF のバージョンを選択することができます。PDF のバージョンはファイルタイプの右側にある選択項目の中から必要なものを選択して下さい。

**カラーモード** の項目は、変換後のフォントや図形、埋め込まれた画像などの色を指定する事ができます。設定可能な項目は以下の通りです。

* **自動**  
  印刷データの色をそのまま保持します。
* **RGB**  
  RGB に変換します。この設定は、ほとんどの場合で **自動** と同様です。
* **グレースケール**  
  グレースケールに変換します。
* **白黒**  
  白黒 2 値に変換します。尚、この設定は PNG、BMP、TIFF でのみ有効です。
  それ以外のファイルタイプの場合、**グレースケール** として変換されます。

**解像度** の項目は、主にファイルサイズの圧縮（ダウンサンプリング）のために使用されます。そのため、変換元のデータ以上の解像度を設定しても、品質やファイルサイズが変化しない場合があります。また、ファイルタイプが PDF, PS, EPS の場合、埋め込まれている画像のみ設定を影響を受けます。

**ページの向き** の項目は、変換後のファイルの向きを設定する事ができます。設定可能な項目は以下の通りです。

* **縦・横**  
  全てのページを縦、または横方向に揃えます。
* **自動**  
  PDF を選択した場合のみ有効な設定で、元ファイルの各ページの向きを保持します。ファイルタイプが PDF 以外の場合、縦を選択した時と同様の挙動となります。

変換に関するその他のオプションは以下の通りです。

* **PDF ファイル中の画像を JPEG 形式で圧縮する**  
  埋め込まれている画像を JPEG 形式に圧縮した上で変換処理を実行します。
* **PDF ファイルを Web 表示用に最適化する**  
  Web 上で PDF ファイルを閲覧する場合、通常は全てのデータがダウンロードし終わるまで待つ必要があります。このオプションを有効にすると、ダウンロードの完了した部分を先に表示する事ができるような形に最適化されます。これは Linearized PDF と呼ばれる仕様です。ただし、このオプションは **パスワードによって保護されている PDF ファイルには適用する事ができません**。CubePDF は、何らかのセキュリティ設定が指定されている場合、このオプションを無視します。

**ポストプロセス** の項目は、CubePDF による変換処理が終了した後に実行する操作を設定する事ができます。設定可能な項目は以下の通りです。

* **開く**  
  変換後のファイルを関連付けられたアプリケーションで開きます。
* **フォルダを開く**  
  変換後のファイルを保存したフォルダを開きます。
* **何もしない**  
  変換処理終了後、何もせずに終了します。
* **その他**  
  任意のプログラムを指定できます。

尚、任意のプログラムを指定した場合、CubePDF は変換後のファイルのパスを引数にして実行します。

### 文書プロパティ

![文書プロパティ](https://raw.githubusercontent.com/cube-soft/cube.assets/master/cubepdf/doc/v4/ja/main/metadata.png)

ファイルタイプで PDF を選択した場合、タイトルや作成者などの情報を登録する事ができます。ここで登録した情報は、Adobe Acrobat Reader DC などの PDF 閲覧ソフトのプロパティ画面で閲覧する事ができます。また、**ページレイアウト** の項目は、PDF 閲覧ソフトで開いた時の表示方法を変更する事ができます。

尚、これらの情報の入力を省略した場合、CubePDF は、タイトル、作成者、サブタイトル、キーワードの情報は空欄に、変換ソフトの情報は「CubePDF」に設定した状態で PDF ファイルを作成します。

#### 変換元のメタ情報について

![変換元メタ情報の扱い](https://raw.githubusercontent.com/cube-soft/cube.assets/master/cubepdf/doc/v4/ja/misc/metadata.png)

CubePDF は、変換後の PDF ファイルを公開する際に、印刷元ファイルに設定されているタイトルや作成者等のメタ情報（文書プロパティ）が意図しない形で漏洩する事例が存在する事を踏まえて、これらの情報は自動的に消去する方針にしています。詳細については、[CubePDF は Office 等からの変換時にメタ情報を消去します](/entry/2020/05/28/cubepdf-remove-metadata) も参照下さい。

### セキュリティ

ファイルタイプで PDF を選択した場合、作成された PDF ファイルにパスワードを設定する事ができます。パスワードを設定する場合は、まず **PDF ファイルをパスワードで保護する** の項目を有効にし、**管理用パスワード** とパスワード確認の項目に同じパスワードを 2 回 入力してください。

![セキュリティ](https://raw.githubusercontent.com/cube-soft/cube.assets/master/cubepdf/doc/v4/ja/main/security.png)

次に、**操作** の項目で、ユーザに許可・制限する操作を指定します。設定可能な項目は以下の通りです。

* PDF ファイルを開く時にパスワードを要求する
* 印刷を許可する
* テキストや画像のコピーを許可する
* ページの挿入、回転、削除を許可する
* アクセシビリティのための内容の抽出を許可する
* フォームへの入力を許可する
* 注釈の追加、編集を許可する

#### パスワード共用に関する注意

**PDF ファイルを開く時にパスワードを要求する** の項目を有効にする際、**管理用パスワードと共用する** の項目も有効にすると、CubePDF は、閲覧用パスワードに管理用パスワードと同じものを設定します。

ただし、**管理用パスワードと閲覧用パスワードを共有した場合、PDF 閲覧ソフトによっては、印刷やコピー操作等の制限が正常に機能しない事があります**。これは、PDF 閲覧ソフトが管理用パスワードで PDF ファイルを開いたと認識するためと予想されます。そのため、CubePDF では、管理用パスワードと共用した場合、その他の操作に関する許可設定を受け付けないように設計しています。

また、管理用パスワードで PDF ファイルを開いたと認識された場合、閲覧用パスワードの除去も含めた全ての PDF 編集が可能になります。閲覧用パスワードを管理用パスワードと共用する場合、これらの動作を十分に理解した上でご利用下さい。

#### パスワードの設定・解除を目的とした再変換に関する注意

PDF ファイルに対してパスワードを設定する目的で、CubePDF を用いて PDF ファイルを再変換する事例が見られます（Microsoft Edge や Adobe Acrobat Reader DC 等で PDF ファイルを表示して印刷を実行）。この方法を用いた場合、いったん印刷処理が実行される都合上、元々の PDF と見た目が異なる可能性もあるのでご注意下さい。PDF ファイルに対するパスワード設定が目的の場合、[CubePDF Utility](https://www.cube-soft.jp/cubepdfutility/) や [CubePDF Page](https://www.cube-soft.jp/cubepdfpage/) の利用もご検討下さい。

また、これとは反対に PDF ファイルに設定されているパスワードや各種セキュリティ設定を除去する目的で PDF ファイルを再変換する事例も見られます。しかし、印刷を実行するアプリケーションによっては印刷時に各種セキュリティ設定を伝搬する事も多く、この場合 CubePDF は変換に失敗します。この操作に関しては、完全にサポート対象外となります。この挙動の変更を目的とした修正が行われる事もありませんので、ご了承下さい。

### その他の設定およびバージョン情報

![その他の設定およびバージョン情報](https://raw.githubusercontent.com/cube-soft/cube.assets/master/cubepdf/doc/v4/ja/main/version.png)

**バージョン情報** では、実行時の CubePDF、Windows、および .NET Framework のバージョン情報が表示されます。また、x86、x64、または ARM64 の内、どのエディションが実行されているのかも、ここで確認する事ができます。

**起動時にアップデートを確認する** の項目を有効にすると、CubePDF のバージョンアップ時にパソコンの右下に通知されます。アップデートの確認は、1 日 1 回、パソコンの起動時に実行されます。また、アップデートの確認のために送信する情報は、CubePDF, Windows, .NET Framework それぞれのバージョン番号です。

**表示言語** では、CubePDF メイン画面のメニュー等の表示言語を設定する事ができます。対応言語は英語 (English)、ドイツ語 (German)、および日本語の (Japanese) 3 種類です。また、表示言語で自動を選択した場合、Windows の言語設定に応じてどちらかの言語が自動的に選択されます。

### 設定の保存

CubePDF のメイン画面において、左下の **設定を保存** ボタンをクリックすると、その時点の各種設定情報がレジストリに保存されます。そして、次回以降の CubePDF 起動時における各種設定の初期状態として使用されるようになります。

例えば、CubePDF は初期設定ではデスクトップに変換したファイルを保存しますが、出力ファイルで別のフォルダを指定後に設定を保存ボタンをクリックすると、次回以降は指定されたフォルダを保存フォルダの初期設定として利用するようになります。

ただし、セキュリティの各種項目および、出力ファイルのファイル名部分は設定を保存機能の対象外です。

## CubePDF プリンターの設定

![印刷設定](https://raw.githubusercontent.com/cube-soft/cube.assets/master/cubepdf/doc/v4/ja/printer/windows8.png)

CubePDF は、これまでに説明したアプリケーションの設定以外に、**CubePDF プリンター** に対する設定も存在します。プリンターの設定を変更するためには、**設定** から **デバイス**、**プリンターとスキャナー** の順で表示される画面で CubePDF を選択し、さらに **管理**、**印刷設定** の順で選択して下さい。尚、Windows 7 以前の場合、**コントロールパネル** の **デバイスとプリンターの表示** で表示される画面で CubePDF を右クリックし **印刷設定** を選択して下さい。

![印刷の詳細オプション](https://raw.githubusercontent.com/cube-soft/cube.assets/master/cubepdf/doc/v4/ja/printer/options.png)

印刷設定では、**用紙/品質** タブで白黒またはカラーで印刷する設定を変更する事ができます。また、それ以外の設定を行う場合、右下にある **詳細設定** ボタンをクリックします。

**用紙サイズ** は、変換後の各ページのサイズに反映されます。設定可能な値は、A0-A6、B0-B6、はがき、角形 1 号-角形 4 号など実際の用紙サイズに対応した値が中心となります。尚、**Slide** は Microsoft PowerPoint の初期値 (4:3) に相当するサイズとなります。

**印刷品質** は、画像データの変換後の品質に影響し、値が高いほど高品質になりファイルサイズも増大します。尚、CubePDF のアプリケーション側に存在する **解像度** の設定は、ここで設定した値が上限となります。

**拡大縮小** は、変換元のコンテンツを拡大または縮小した状態で変換するための設定で、等倍で変換する場合は 100 となります。尚、一部の環境で、この初期値が非常に大きな値に設定されている事例が見られます。変換後の PDF などが異常に大きな状態となっている場合、この設定を確認して下さい。

**PostScript オプション** 下にある **TrueType フォント ダウンロードオプション** は、文字の変換法に関する設定で、設定可能な項目は以下の通りです。

* **Native TrueType**  
  フォント情報などを保ったまま、文字として、変換します。ただし、Google Chrome や Microsoft Edge などの多くの Web ブラウザを始めとして、アプリケーションの中には印刷処理で文字を図形として変換するアウトライン化を実施するものもあります。この場合、プリンターの設定に関わらず、文字としての情報は失われてしまうのでご注意下さい。
* **アウトライン**  
  印刷時に文字を図形として変換します。この場合、フォント情報など文字としての情報は失われますが、変換後の位置ずれなどの問題を軽減する効果があります。
* **ビットマップ**  
  印刷時に文字をビットマップ画像として変換します。こちらも位置ずれなどの問題を解決する事がありますが、印刷品質など他の設定内容によってはギザギザ感が目立つなどの問題が発生する事もあります。
* **自動**  
  プリンターが、Native TrueType、アウトライン、ビットマップの設定のどれかを自動的に選択します。

**PostScript オプション** 下にある **左右反転印刷** は、変換元のコンテンツを左右または上下に反転した状態で変換するための設定で、通常は **いいえ** に設定されています。一部の環境で、この初期値が **はい** となっている事例が見られます。変換後の PDF が上下左右反転している場合、この設定を確認して下さい。

### 注意

印刷を実行するアプリケーションによっては、独自の印刷設定画面を用意しているなどの関係で、CubePDF プリンターの設定が反映されない事があります。印刷設定に関しては、利用するアプリケーションの設定も注意深く確認するようお願いします。

## CubePDF のアンインストール

![CubePDF のアンインストール](https://raw.githubusercontent.com/cube-soft/cube.assets/master/cubepdf/doc/v4/ja/uninstall/windows8.png)

CubePDF をアンインストールするには、設定の **アプリと機能**、またはコントロールパネルの **プログラムのアンインストール** を選択します。そして、表示される画面で CubePDF のアイコンを選択してアンインストールの項目を実行して下さい。

## CubePDF で問題が発生した場合

CubePDF は、```C:\ProgramData\CubeSoft\CubePdf\Log``` フォルダに実行ログを出力しています。問題が発生した時は、これらのログを添付して support@cube-soft.jp までご連絡お願いします。